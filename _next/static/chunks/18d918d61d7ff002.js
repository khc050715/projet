(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"warnOnce",{enumerable:!0,get:function(){return r}});let r=e=>{}},18566,(e,t,a)=>{t.exports=e.r(76562)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},27516,e=>{"use strict";let t=(0,e.i(75254).default)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);e.s(["History",()=>t],27516)},28180,e=>{"use strict";var t=e.i(18050),a=e.i(71645),r=e.i(18566);e.i(36180);var s=e.i(98925),l=e.i(59141);e.i(51718);var i=e.i(18357),o=e.i(71689),n=e.i(75254);let d=(0,n.default)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var c=e.i(31278);let x=(0,n.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),h=(0,n.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var m=e.i(27516);let u=(0,n.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var f=e.i(22016);let b=(0,e.i(70703).default)(()=>e.A(88174),{loadableGenerated:{modules:[72113]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"text-gray-500",children:"Loading content..."})});function y(){let e=(0,r.useRouter)(),n=(0,r.useSearchParams)().get("id"),[y,g]=(0,a.useState)(null),[p,v]=(0,a.useState)(null),[j,w]=(0,a.useState)(null),[N,k]=(0,a.useState)([]),[_,L]=(0,a.useState)(!0),[S,M]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let t=(0,i.onAuthStateChanged)(l.auth,async t=>{if(!t)return void e.push("/");if(g(t),n)try{let t=(0,s.doc)(l.db,"records",n),a=await (0,s.getDoc)(t);if(a.exists()){let e={id:a.id,...a.data()};v(e),w(e);let r=(0,s.query)((0,s.collection)(t,"revisions"),(0,s.orderBy)("archived_at","desc")),l=(await (0,s.getDocs)(r)).docs.map(e=>({id:e.id,...e.data()}));k(l)}else alert("기록을 찾을 수 없습니다."),e.push("/")}catch(e){console.error(e)}finally{L(!1)}});return()=>t()},[n,e]);let C=()=>{w(p),M(!1)};return _?(0,t.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center text-gray-500",children:(0,t.jsx)(c.Loader2,{className:"animate-spin"})}):j?(0,t.jsxs)("main",{className:"min-h-screen bg-black text-gray-200 p-6 md:p-12 max-w-6xl mx-auto border-x border-gray-900/50 flex flex-col lg:flex-row gap-12",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("nav",{className:"flex justify-between items-center mb-12",children:[(0,t.jsxs)(f.default,{href:"/",className:"text-gray-500 hover:text-white flex items-center gap-2 transition-colors",children:[(0,t.jsx)(o.ArrowLeft,{className:"w-4 h-4"})," Back to List"]}),(0,t.jsxs)(f.default,{href:`/edit?id=${p.id}`,className:"flex items-center gap-2 px-4 py-2 bg-gray-900 hover:bg-yellow-900/20 text-gray-400 hover:text-yellow-500 rounded transition-all border border-gray-800 hover:border-yellow-900/50",children:[(0,t.jsx)(d,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-sm font-bold",children:"Edit Knot"})]})]}),S&&(0,t.jsxs)("div",{className:"mb-6 bg-yellow-900/20 border border-yellow-700/50 text-yellow-500 p-4 rounded-lg flex items-center justify-between animate-in slide-in-from-top-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.History,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"font-bold",children:"과거의 기록을 보고 있습니다."})]}),(0,t.jsxs)("button",{onClick:C,className:"flex items-center gap-1 text-sm underline hover:text-white",children:[(0,t.jsx)(u,{className:"w-3 h-3"})," 최신으로 복귀"]})]}),(0,t.jsxs)("header",{className:"mb-10 pb-6 border-b border-gray-900 space-y-4",children:[(0,t.jsx)("h1",{className:"text-4xl md:text-5xl font-bold text-white leading-tight break-words",children:j.title}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500 font-mono",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(x,{className:"w-4 h-4"})," ",j.created_at?.toDate().toLocaleDateString()]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(h,{className:"w-4 h-4"})," ",j.created_at?.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),p.revision_count>0&&!S&&(0,t.jsxs)("span",{className:"text-yellow-700 bg-yellow-900/10 px-2 py-0.5 rounded text-xs border border-yellow-900/30",children:["Rev.",p.revision_count]})]})]}),(0,t.jsx)("article",{className:"min-h-[50vh] animate-in fade-in duration-500",children:(0,t.jsx)(b,{markdown:j.content,readOnly:!0})})]}),(0,t.jsxs)("aside",{className:"w-full lg:w-80 space-y-6 pt-20 border-t lg:border-t-0 lg:border-l border-gray-900 lg:pl-10",children:[(0,t.jsxs)("h3",{className:"text-gray-400 font-bold uppercase text-sm tracking-widest flex items-center gap-2",children:[(0,t.jsx)(m.History,{className:"w-4 h-4"})," Revision History"]}),(0,t.jsxs)("div",{className:"relative space-y-6 before:absolute before:inset-0 before:ml-1.5 before:-translate-x-px md:before:mx-auto md:before:translate-x-0 before:h-full before:w-0.5 before:bg-gradient-to-b before:from-transparent before:via-gray-800 before:to-transparent",children:[(0,t.jsxs)("div",{className:"relative flex items-center justify-between md:justify-normal md:odd:flex-row-reverse group is-active",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-4 h-4 rounded-full border border-green-500 bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.4)] z-10 shrink-0"}),(0,t.jsxs)("button",{onClick:C,className:`ml-4 w-full p-3 rounded border transition-all text-left ${!S?"bg-green-900/10 border-green-500/50 text-green-100":"bg-[#111] border-gray-800 text-gray-400 hover:border-gray-600"}`,children:[(0,t.jsx)("div",{className:"text-xs font-bold mb-1",children:"Current Version"}),(0,t.jsx)("div",{className:"text-[10px] font-mono opacity-70",children:p.updated_at?p.updated_at.toDate().toLocaleString():"Latest"})]})]}),0===N.length&&(0,t.jsx)("div",{className:"pl-6 text-xs text-gray-600 italic",children:"수정 내역이 없습니다."}),N.map(e=>(0,t.jsxs)("div",{className:"relative flex items-center justify-between md:justify-normal md:odd:flex-row-reverse group",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-3 h-3 rounded-full border border-gray-600 bg-[#0a0a0a] group-hover:border-yellow-500 group-hover:bg-yellow-500 transition-all z-10 shrink-0"}),(0,t.jsxs)("button",{onClick:()=>{w({...p,title:e.snapshot_title,content:e.snapshot_content,created_at:e.snapshot_created_at||e.archived_at}),M(!0),window.scrollTo({top:0,behavior:"smooth"})},className:`ml-5 w-full p-3 rounded border text-left transition-all ${S&&j.content===e.snapshot_content?"bg-yellow-900/20 border-yellow-600 text-yellow-100":"bg-[#0a0a0a] border-gray-800 text-gray-500 hover:border-gray-600 hover:text-gray-300"}`,children:[(0,t.jsx)("div",{className:"text-xs font-bold mb-1 truncate",children:e.snapshot_title}),(0,t.jsx)("div",{className:"text-[10px] font-mono opacity-50",children:e.archived_at?.toDate().toLocaleString()})]})]},e.id))]})]})]}):null}function g(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center text-gray-500",children:"Loading..."}),children:(0,t.jsx)(y,{})})}e.s(["default",()=>g],28180)},88174,e=>{e.v(t=>Promise.all(["static/chunks/fac2aa90d5f39e2e.js","static/chunks/c0a0c0f35d0a8771.css"].map(t=>e.l(t))).then(()=>t(72113)))}]);